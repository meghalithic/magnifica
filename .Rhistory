for (i in seq_along(Gmat)){
colnames(Gmat[[i]]) <- traits
}
for (i in seq_along(Gmat)){
rownames(Gmat[[i]]) <- traits
}
diag(Gmat[[2]]) < diag(Pmat[[2]]) # all larger
#### MANIPULATE DATA ----
traits = names(df[, c("ln.zl", "ln.mpw.b", "ln.cw.m", "ln.cw.d",
"ln.ow.m", "ln.ol", "ln.c.side", "ln.o.side")])
df <- read.csv("./Results/traits_1Jul2024.csv", #30Nov2023,29Sept2023.csv",
header = TRUE)
#### MANIPULATE DATA ----
traits = names(df[, c("ln.zl", "ln.mpw.b", "ln.cw.m", "ln.cw.d",
"ln.ow.m", "ln.ol", "ln.c.side", "ln.o.side")])
# why aren't traits labeled??
for (i in seq_along(Gmat)){
colnames(Gmat[[i]]) <- traits
}
for (i in seq_along(Gmat)){
rownames(Gmat[[i]]) <- traits
}
diag(Gmat[[2]]) < diag(Pmat[[2]]) # all larger
diag(Gmat[[4]]) < diag(Pmat[[4]]) # all larger
diag(Gmat[[5]]) < diag(Pmat[[5]]) # all larger
##### G VARIANCES -----
lapply(Gmat, isSymmetric)  #is.symmetric.matrix
g.variances = lapply(Gmat, diag)
paste("Trait variances")
head(g.variances)
##### G EIGEN -----
g.eig_variances = lapply(Gmat, function (x) {eigen(x)$values})
G_ext_NKLS = round(as.matrix(G_ext[[1]]), 6) # The G matrix estimated for sample/formation 1
G_ext_NKBS = round(as.matrix(G_ext[[2]]), 6) # The G matrix estimated for sample/formation 2
G_ext_tewk = round(as.matrix(G_ext[[3]]), 6) # The G matrix estimated for sample/formation 3
G_ext_uki = round(as.matrix(G_ext[[4]]), 6) # The G matrix estimated for sample/formation 5
G_ext_tai = round(as.matrix(G_ext[[5]]), 6) # The G matrix estimated for sample/formation 6
G_ext_SHCSBSB = round(as.matrix(G_ext[[6]]), 6) # The G matrix estimated for sample/formation 7
G_ext_mod = round(as.matrix(G_ext[[7]]), 6) # The G matrix estimated for sample/formation 7
G_ext_mod
is.symmetric.matrix(G_ext_NKLS)
is.positive.definite(G_ext_NKLS)
is.symmetric.matrix(G_ext_NKBS)
is.positive.definite(G_ext_NKBS)
is.symmetric.matrix(G_ext_tewk)
is.positive.definite(G_ext_tewk)
is.symmetric.matrix(G_ext_uki)
is.positive.definite(G_ext_uki)
is.symmetric.matrix(G_ext_tai)
is.positive.definite(G_ext_tai)
is.symmetric.matrix(G_ext_SHCSBSB)
is.positive.definite(G_ext_SHCSBSB)
is.symmetric.matrix(G_ext_mod)
is.positive.definite(G_ext_mod)
#trait means by time
mean_by_formation
### Calculate the vector that defines the observed divergence between sample/formation 1
# A vector containing trait means from sample/formation
NKLS <- as.numeric(mean_by_formation[mean_by_formation == "NKLS", c("avg.zl", "avg.mpw.b", "avg.cw.m", "avg.cw.d", "avg.ow.m", "avg.ol", "avg.o.side", "avg.c.side")])
NKBS <- as.numeric(mean_by_formation[mean_by_formation == "NKBS", c("avg.zl", "avg.mpw.b", "avg.cw.m", "avg.cw.d", "avg.ow.m", "avg.ol", "avg.o.side", "avg.c.side")])
tewk <- as.numeric(mean_by_formation[mean_by_formation == "Tewkesbury", c("avg.zl", "avg.mpw.b", "avg.cw.m", "avg.cw.d", "avg.ow.m", "avg.ol", "avg.o.side", "avg.c.side")])
uki <- as.numeric(mean_by_formation[mean_by_formation == "Upper Kai-Iwi", c("avg.zl", "avg.mpw.b", "avg.cw.m", "avg.cw.d", "avg.ow.m", "avg.ol", "avg.o.side", "avg.c.side")])
tai <- as.numeric(mean_by_formation[mean_by_formation == "Tainui", c("avg.zl", "avg.mpw.b", "avg.cw.m", "avg.cw.d", "avg.ow.m", "avg.ol", "avg.o.side", "avg.c.side")])
SHCSBSB <- as.numeric(mean_by_formation[mean_by_formation == "SHCSBSB", c("avg.zl", "avg.mpw.b", "avg.cw.m", "avg.cw.d", "avg.ow.m", "avg.ol", "avg.o.side", "avg.c.side")])
mod <- as.numeric(mean_by_formation[mean_by_formation == "modern", c("avg.zl", "avg.mpw.b", "avg.cw.m", "avg.cw.d", "avg.ow.m", "avg.ol", "avg.o.side", "avg.c.side")])
## really need to learn how to name things in functions...
evolved_difference_unit_length_t1 <- f.normalize_vector(NKBS - NKLS)
evolved_difference_unit_length_t2 <- f.normalize_vector(tewk - NKBS)
evolved_difference_unit_length_t3 <- f.normalize_vector(uki - tewk)
evolved_difference_unit_length_t4 <- f.normalize_vector(tai - uki)
evolved_difference_unit_length_t5 <- f.normalize_vector(SHCSBSB - tai)
evolved_difference_unit_length_t6 <- f.normalize_vector(mod - SHCSBSB)
###### OBSERVED EVOLVABILITY ------
### The evolvability in the direction of divergence from sample/formation 1 to sample/formation 2
#observed_evolvability_in_direction_of_change<-t(evolved_difference_unit_length)%*%as.matrix(G_matrix_1)%*%evolved_difference_unit_length
observed_evolvability_in_direction_of_change_t1 <- t(evolved_difference_unit_length_t1)%*%as.matrix(G_ext_NKLS)%*%evolved_difference_unit_length_t1
observed_evolvability_in_direction_of_change_t2 <- t(evolved_difference_unit_length_t2)%*%as.matrix(G_ext_NKBS)%*%evolved_difference_unit_length_t2
observed_evolvability_in_direction_of_change_t3 <- t(evolved_difference_unit_length_t3)%*%as.matrix(G_ext_tewk)%*%evolved_difference_unit_length_t3
observed_evolvability_in_direction_of_change_t4 <- t(evolved_difference_unit_length_t4)%*%as.matrix(G_ext_uki)%*%evolved_difference_unit_length_t4
observed_evolvability_in_direction_of_change_t5 <- t(evolved_difference_unit_length_t5)%*%as.matrix(G_ext_tai)%*%evolved_difference_unit_length_t5
observed_evolvability_in_direction_of_change_t6 <- t(evolved_difference_unit_length_t6)%*%as.matrix(G_ext_SHCSBSB)%*%evolved_difference_unit_length_t6
###### OBSERVED CONDITIONAL EVOLVABILITY ------
### The conditional evolvability in the direction of divergence
#observed_conditional_evolvability_in_direction_of_change<-1/(t(evolved_difference_unit_length)%*%solve(as.matrix(G_matrix_1))%*%evolved_difference_unit_length)
observed_conditional_evolvability_in_direction_of_change_t1 <- 1/(t(evolved_difference_unit_length_t1)%*%solve(as.matrix(G_ext_NKLS))%*%evolved_difference_unit_length_t1)
observed_conditional_evolvability_in_direction_of_change_t2 <- 1/(t(evolved_difference_unit_length_t2)%*%solve(as.matrix(G_ext_NKBS))%*%evolved_difference_unit_length_t2)
observed_conditional_evolvability_in_direction_of_change_t3 <- 1/(t(evolved_difference_unit_length_t3)%*%solve(as.matrix(G_ext_tewk))%*%evolved_difference_unit_length_t3)
observed_conditional_evolvability_in_direction_of_change_t4 <- 1/(t(evolved_difference_unit_length_t4)%*%solve(as.matrix(G_ext_uki))%*%evolved_difference_unit_length_t4)
observed_conditional_evolvability_in_direction_of_change_t5 <- 1/(t(evolved_difference_unit_length_t5)%*%solve(as.matrix(G_ext_tai))%*%evolved_difference_unit_length_t5)
observed_conditional_evolvability_in_direction_of_change_t6 <- 1/(t(evolved_difference_unit_length_t6)%*%solve(as.matrix(G_ext_SHCSBSB))%*%evolved_difference_unit_length_t6)
### Generate 10,000 selection gradients in random directions in the n-dimensional space
n_dimensions <- 8 # number of traits in G matrix
Beta <- randomBeta(10000, n_dimensions)
# Compute the mean, minimum and maximum evolvability (e_mean, e_min, e_max) for a G matrix based on 10,000 random selection gradients
X_t1 <- evolvabilityBeta(as.matrix(G_ext_NKLS), Beta)
sumX_t1 <- summary(X_t1) #provides you with info on mean, minimum and maximum evolvability  (e_mean, e_min, e_max) and conditional evolvability  (c_mean, c_min, c_max) for a given G matrix
X_t2 <- evolvabilityBeta(as.matrix(G_ext_NKBS), Beta)
sumX_t2 <- summary(X_t2) #provides you with info on mean, minimum and maximum evolvability  (e_mean, e_min, e_max) and conditional evolvability  (c_mean, c_min, c_max) for a given G matrix
X_t3 <- evolvabilityBeta(as.matrix(G_ext_tewk), Beta)
sumX_t3 <- summary(X_t3) #provides you with info on mean, minimum and maximum evolvability  (e_mean, e_min, e_max) and conditional evolvability  (c_mean, c_min, c_max) for a given G matrix
X_t4 <- evolvabilityBeta(as.matrix(G_ext_uki), Beta)
sumX_t4 <- summary(X_t4) #provides you with info on mean, minimum and maximum evolvability  (e_mean, e_min, e_max) and conditional evolvability  (c_mean, c_min, c_max) for a given G matrix
X_t5 <- evolvabilityBeta(as.matrix(G_ext_tai), Beta)
sumX_t5 <- summary(X_t5) #provides you with info on mean, minimum and maximum evolvability  (e_mean, e_min, e_max) and conditional evolvability  (c_mean, c_min, c_max) for a given G matrix
X_t6 <- evolvabilityBeta(as.matrix(G_ext_SHCSBSB), Beta)
sumX_t6 <- summary(X_t6) #provides you with info on mean, minimum and maximum evolvability  (e_mean, e_min, e_max) and conditional evolvability  (c_mean, c_min, c_max) for a given G matrix
X_t7 <- evolvabilityBeta(as.matrix(G_ext_mod), Beta)
sumX_t7 <- summary(X_t7) #provides you with info on mean, minimum and maximum evolvability  (e_mean, e_min, e_max) and conditional evolvability  (c_mean, c_min, c_max) for a given G matrix
X_sum <- data.frame(c.mean = c(sumX_t1$Averages[[3]], sumX_t2$Averages[[3]], sumX_t3$Averages[[3]],
sumX_t4$Averages[[3]], sumX_t5$Averages[[3]], sumX_t6$Averages[[3]],
sumX_t7$Averages[[3]]),
c.min = c(sumX_t1$Minimum[[3]], sumX_t2$Minimum[[3]], sumX_t3$Minimum[[3]],
sumX_t4$Minimum[[3]], sumX_t5$Minimum[[3]], sumX_t6$Minimum[[3]],
sumX_t7$Minimum[[3]]),
c.max = c(sumX_t1$Maximum[[3]], sumX_t2$Maximum[[3]], sumX_t3$Maximum[[3]],
sumX_t4$Maximum[[3]], sumX_t5$Maximum[[3]], sumX_t6$Maximum[[3]],
sumX_t7$Maximum[[3]]),
e.mean = c(sumX_t1$Averages[[1]], sumX_t2$Averages[[1]], sumX_t3$Averages[[1]],
sumX_t4$Averages[[1]], sumX_t5$Averages[[1]], sumX_t6$Averages[[1]],
sumX_t7$Averages[[1]]),
e.min = c(sumX_t1$Minimum[[1]], sumX_t2$Minimum[[1]], sumX_t3$Minimum[[1]],
sumX_t4$Minimum[[1]], sumX_t5$Minimum[[1]], sumX_t6$Minimum[[1]],
sumX_t7$Minimum[[1]]),
e.max = c(sumX_t1$Maximum[[1]], sumX_t2$Maximum[[1]], sumX_t3$Maximum[[1]],
sumX_t4$Maximum[[1]], sumX_t5$Maximum[[1]], sumX_t6$Maximum[[1]],
sumX_t7$Maximum[[1]]),
observed_e = c(observed_evolvability_in_direction_of_change_t1,
observed_evolvability_in_direction_of_change_t2,
observed_evolvability_in_direction_of_change_t3,
observed_evolvability_in_direction_of_change_t4,
observed_evolvability_in_direction_of_change_t5,
observed_evolvability_in_direction_of_change_t6,
""),
observed_c = c(observed_conditional_evolvability_in_direction_of_change_t1,
observed_conditional_evolvability_in_direction_of_change_t2,
observed_conditional_evolvability_in_direction_of_change_t3,
observed_conditional_evolvability_in_direction_of_change_t4,
observed_conditional_evolvability_in_direction_of_change_t5,
observed_conditional_evolvability_in_direction_of_change_t6,
""),
row.names = levels(formation_list))
## PLOT
X_sum$formation <- rownames(X_sum)
X_sum$formation <- factor(X_sum$formation, levels = c("NKLS", "NKBS",
"Tewkesbury", "Upper Kai-Iwi",
"Tainui", "SHCSBSB", "modern"))
X_sum$form.trans <- formation_transition
X_sum$form.trans <- factor(X_sum$form.trans,
levels = c("NKLS to NKBS",
"NKBS to Tewkesbury",
"Tewkesbury to Upper Kai-Iwi",
"Upper Kai-Iwi to Tainui",
"Tainui to SHCSBSB",
"SHCSBSB to modern", ""))
X_sum.trim <- X_sum[1:6,]
p.evol <- ggplot(X_sum.trim, aes(x = form.trans)) +
geom_boxplot(aes(ymin = e.min,
lower = e.min,
middle = e.mean,
ymax = e.max,
upper = e.max,
fill = "gray"),
stat = "identity", fill = "gray") +
geom_point(aes(y = as.numeric(observed_e),
color = "black"),
size = 5, shape = 17, color = "black") +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "Evolvability") +
plot.theme
p.evol
colnames(X_sum.trim)
##evolvability over time:
ggplot(X_sum.trim, aes(x = form.trans)) +
geom_point(aes(y = e.mean),
size = 5, shape = 15, color = "black") +
geom_smooth(aes(y = e.mean)) +
geom_point(aes(y = as.numeric(observed_e),
color = "black"),
) +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "Evolvability") +
plot.theme
##evolvability over time:
ggplot(X_sum.trim, aes(x = form.trans)) +
geom_point(aes(y = e.mean),
size = 5, shape = 15, color = "black") +
geom_smooth(aes(y = e.mean)) +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "Evolvability") +
plot.theme
colnames(X_sum.trim)
X_sum.trim$formation
mean(2.291,2.088)
mean(c(2.291,2.088))
mean(c(2.017,1.915))
mean(c(1.875,1.826))
mean(c(0.676,0.621))
mean(c(0.533,0.478))
mean(c(0.478, 0.424))
#does not change a lot
X_sum.trim$ages <- c(2.2, 1.9, 1.85, 0.75, 0.5, 0.45, 0)
#does not change a lot
X_sum.trim$ages <- c(2.2, 1.9, 1.85, 0.75, 0.5, 0.45)
summary(lm(X_sum.trim$e.mean ~ X_sum.trim$ages))
#### LOOK AT SCALING OF PC1 AND PC2 OVER TIME -----
Gmax_NKLS_scaled = Gmax_NKLS/(G2_NKLS + G3_NKLS + G4_NKLS)
Gmax_NKBS_scaled = Gmax_NKBS/(G2_NKBS + G3_NKBS + G4_NKBS)
### How much is the direction of Gmax (i.e., the direction first ) varying between different G-matrices?
Gmax_NKLS <- eigen(G_ext_NKLS)$vectors[,1]
Gmax_NKBS <- eigen(G_ext_NKBS)$vectors[,1]
Gmax_tewk <- eigen(G_ext_tewk)$vectors[,1]
Gmax_uki <- eigen(G_ext_uki)$vectors[,1]
Gmax_tai <- eigen(G_ext_tai)$vectors[,1]
Gmax_SHCSBSB <- eigen(G_ext_SHCSBSB)$vectors[,1]
Gmax_mod <- eigen(G_ext_mod)$vectors[,1]
# Put Gmax to norm length
Gmax_NKLS_norm <- f.normalize_vector(Gmax_NKLS)
Gmax_NKBS_norm <- f.normalize_vector(Gmax_NKBS)
Gmax_tewk_norm <- f.normalize_vector(Gmax_tewk)
Gmax_uki_norm <- f.normalize_vector(Gmax_uki)
Gmax_tai_norm <- f.normalize_vector(Gmax_tai)
Gmax_SHCSBSB_norm <- f.normalize_vector(Gmax_SHCSBSB)
Gmax_mod_norm <- f.normalize_vector(Gmax_mod)
###### PC2-4 compared to âˆ†z -----
## do for 2-4 as well
G2_NKLS <- eigen(G_ext_NKLS)$vectors[,2]
G2_NKBS <- eigen(G_ext_NKBS)$vectors[,2]
G2_tewk <- eigen(G_ext_tewk)$vectors[,2]
G2_uki <- eigen(G_ext_uki)$vectors[,2]
G2_tai <- eigen(G_ext_tai)$vectors[,2]
G2_SHCSBSB <- eigen(G_ext_SHCSBSB)$vectors[,2]
G2_mod <- eigen(G_ext_mod)$vectors[,2]
G3_NKLS <- eigen(G_ext_NKLS)$vectors[,3]
G3_NKBS <- eigen(G_ext_NKBS)$vectors[,3]
G3_tewk <- eigen(G_ext_tewk)$vectors[,3]
G3_uki <- eigen(G_ext_uki)$vectors[,3]
G3_tai <- eigen(G_ext_tai)$vectors[,3]
G3_SHCSBSB <- eigen(G_ext_SHCSBSB)$vectors[,3]
G3_mod <- eigen(G_ext_mod)$vectors[,3]
G4_NKLS <- eigen(G_ext_NKLS)$vectors[,4]
G4_NKBS <- eigen(G_ext_NKBS)$vectors[,4]
G4_tewk <- eigen(G_ext_tewk)$vectors[,4]
G4_uki <- eigen(G_ext_uki)$vectors[,4]
G4_tai <- eigen(G_ext_tai)$vectors[,4]
G4_SHCSBSB <- eigen(G_ext_SHCSBSB)$vectors[,4]
G4_mod <- eigen(G_ext_mod)$vectors[,4]
## normalize
G2_NKLS_norm <- f.normalize_vector(G2_NKLS)
G2_NKBS_norm <- f.normalize_vector(G2_NKBS)
G2_tewk_norm <- f.normalize_vector(G2_tewk)
G2_uki_norm <- f.normalize_vector(G2_uki)
G2_tai_norm <- f.normalize_vector(G2_tai)
G2_SHCSBSB_norm <- f.normalize_vector(G2_SHCSBSB)
G2_mod_norm <- f.normalize_vector(G2_mod)
G3_NKLS_norm <- f.normalize_vector(G3_NKLS)
G3_NKBS_norm <- f.normalize_vector(G3_NKBS)
G3_tewk_norm <- f.normalize_vector(G3_tewk)
G3_uki_norm <- f.normalize_vector(G3_uki)
G3_tai_norm <- f.normalize_vector(G3_tai)
G3_SHCSBSB_norm <- f.normalize_vector(G3_SHCSBSB)
G3_mod_norm <- f.normalize_vector(G3_mod)
G4_NKLS_norm <- f.normalize_vector(G4_NKLS)
G4_NKBS_norm <- f.normalize_vector(G4_NKBS)
G4_tewk_norm <- f.normalize_vector(G4_tewk)
G4_uki_norm <- f.normalize_vector(G4_uki)
G4_tai_norm <- f.normalize_vector(G4_tai)
G4_SHCSBSB_norm <- f.normalize_vector(G4_SHCSBSB)
G4_mod_norm <- f.normalize_vector(G4_mod)
#### LOOK AT SCALING OF PC1 AND PC2 OVER TIME -----
Gmax_NKLS_scaled = Gmax_NKLS/(G2_NKLS + G3_NKLS + G4_NKLS)
Gmax_NKBS_scaled = Gmax_NKBS/(G2_NKBS + G3_NKBS + G4_NKBS)
Gmax_tewk_scaled = Gmax_tewk/(G2_tewk + G3_tewk + G4_tewk)
Gmax_uki_scaled = Gmax_uki/(G2_uki + G3_uki + G4_uki)
Gmax_tai_scaled = Gmax_tai/(G2_tai + G3_tai + G4_tai)
Gmax_SHCSBSB_scaled = Gmax_SHCSBSB/(G2_SHCSBSB + G3_SHCSBSB + G4_SHCSBSB)
Gmax_mod_scaled = Gmax_mod/(G2_mod + G3_mod + G4_mod)
G2_NKLS_scaled = G2_NKLS/(Gmax_NKLS + G3_NKLS + G4_NKLS)
G2_NKBS_scaled = G2_NKBS/(Gmax_NKBS + G3_NKBS + G4_NKBS)
G2_tewk_scaled = G2_tewk/(Gmax_tewk + G3_tewk + G4_tewk)
G2_uki_scaled = G2_uki/(Gmax_uki + G3_uki + G4_uki)
G2_tai_scaled = G2_tai/(Gmax_tai + G3_tai + G4_tai)
G2_SHCSBSB_scaled = G2_SHCSBSB/(Gmax_SHCSBSB + G3_SHCSBSB + G4_SHCSBSB)
G2_mod_scaled = G2_mod/(Gmax_mod + G3_mod + G4_mod)
pc1 <- c(Gmax_NKLS_scaled, Gmax_NKBS_scaled, Gmax_tewk_scaled,
Gmax_uki_scaled, Gmax_tai_scaled, Gmax_SHCSBSB_scaled,
Gmax_mod_scaled)
pc2 <- c(G2_NKLS_scaled, G2_NKBS_scaled, G2_tewk_scaled,
G2_uki_scaled, G2_tai_scaled, G2_SHCSBSB_scaled,
G2_mod_scaled)
levels(formation_list)
form <- levels(formation_list)
form
pc_time <- as.data.frame(cbind(pc1, pc2, form))
factor(pc_time$form, levels = c("NKLS", "NKBS",
"Tewkesbury", "Upper Kai-Iwi",
"Tainui", "SHCSBSB", "modern"))
##evolvability over time:
ggplot(pc_time, aes(x = form)) +
geom_point(aes(y = pc1),
size = 5, shape = 15, color = "black") +
geom_smooth(aes(y = pc1)) +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "Evolvability") +
plot.theme
pc_time
str(pc_time)
pc_time$pc1 <- as.numeric(pc_time$pc1)
pc_time$pc2 <- as.numeric(pc_time$pc2)
##evolvability over time:
ggplot(pc_time, aes(x = form)) +
geom_point(aes(y = pc1),
size = 5, shape = 15, color = "black") +
geom_smooth(aes(y = pc1)) +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "Evolvability") +
plot.theme
##evolvability over time:
ggplot(pc_time, aes(x = form)) +
geom_point(aes(y = pc1),
size = 5, shape = 15, color = "black") +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "PC1") +
plot.theme
##evolvability over time:
ggplot(pc_time, aes(x = form)) +
geom_point(aes(y = pc1),
size = 5, shape = 15, color = "black") +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "PC1") +
plot.theme
factor(pc_time$form, levels = c("NKLS", "NKBS",
"Tewkesbury", "Upper Kai-Iwi",
"Tainui", "SHCSBSB", "modern"))
pc_time$form <- factor(pc_time$form, levels = c("NKLS", "NKBS",
"Tewkesbury", "Upper Kai-Iwi",
"Tainui", "SHCSBSB", "modern"))
pc_time$form <- factor(pc_time$form, levels = c("NKLS", "NKBS",
"Tewkesbury", "Upper Kai-Iwi",
"Tainui", "SHCSBSB", "modern"))
##evolvability over time:
ggplot(pc_time, aes(x = form)) +
geom_point(aes(y = pc1),
size = 5, shape = 15, color = "black") +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "PC1") +
plot.theme
pc_time
Gmax_NKLS_scaled
Gmax_NKLS
Gmax_NKLS_norm
#### LOOK AT SCALING OF PC1 AND PC2 OVER TIME -----
Gmax_NKLS.val <- eigen(G_ext_NKLS)$value[,1]
eigen(G_ext_NKLS)
#### LOOK AT SCALING OF PC1 AND PC2 OVER TIME -----
Gmax_NKLS.val <- eigen(G_ext_NKLS)$values[,1]
Gmax_NKBS.val <- eigen(G_ext_NKBS)$values[,1]
#### LOOK AT SCALING OF PC1 AND PC2 OVER TIME -----
Gmax_NKLS.val <- eigen(G_ext_NKLS)$values[1]
Gmax_NKBS.val <- eigen(G_ext_NKBS)$values[1]
Gmax_tewk.val <- eigen(G_ext_tewk)$values[1]
Gmax_uki.val <- eigen(G_ext_uki)$values[1]
Gmax_tai.val <- eigen(G_ext_tai)$values[1]
Gmax_SHCSBSB.val <- eigen(G_ext_SHCSBSB)$values[1]
Gmax_mod.val <- eigen(G_ext_mod)$values[1]
G2_NKLS.val <- eigen(G_ext_NKLS)$values[2]
G2_NKBS.val <- eigen(G_ext_NKBS)$values[2]
G2_tewk.val <- eigen(G_ext_tewk)$values[2]
G2_uki.val <- eigen(G_ext_uki)$values[2]
G2_tai.val <- eigen(G_ext_tai)$values[2]
G2_SHCSBSB.val <- eigen(G_ext_SHCSBSB)$values[2]
G2_mod.val <- eigen(G_ext_mod)$values[2]
G3_NKLS.val <- eigen(G_ext_NKLS)$values[3]
G3_NKBS.val <- eigen(G_ext_NKBS)$values[3]
G3_tewk.val <- eigen(G_ext_tewk)$values[3]
G3_uki.val <- eigen(G_ext_uki)$values[3]
G3_tai.val <- eigen(G_ext_tai)$values[3]
G3_SHCSBSB.val <- eigen(G_ext_SHCSBSB)$values[3]
G3_mod.val <- eigen(G_ext_mod)$values[3]
G4_NKLS.val <- eigen(G_ext_NKLS)$values[4]
G4_NKBS.val <- eigen(G_ext_NKBS)$values[4]
G4_tewk.val <- eigen(G_ext_tewk)$values[4]
G4_uki.val <- eigen(G_ext_uki)$values[4]
G4_tai.val <- eigen(G_ext_tai)$values[4]
G4_SHCSBSB.val <- eigen(G_ext_SHCSBSB)$values[4]
G4_mod.val <- eigen(G_ext_mod)$values[4]
Gmax_NKLS_scaled = Gmax_NKLS.val(G2_NKLS.val + G3_NKLS.val + G4_NKLS.val)
Gmax_NKBS_scaled = Gmax_NKBS.val/(G2_NKBS.val + G3_NKBS.val + G4_NKBS.val)
Gmax_tewk_scaled = Gmax_tewk.val/(G2_tewk.val + G3_tewk.val + G4_tewk.val)
Gmax_NKLS_scaled = Gmax_NKLS.val/(G2_NKLS.val + G3_NKLS.val + G4_NKLS.val)
Gmax_NKBS_scaled = Gmax_NKBS.val/(G2_NKBS.val + G3_NKBS.val + G4_NKBS.val)
Gmax_tewk_scaled = Gmax_tewk.val/(G2_tewk.val + G3_tewk.val + G4_tewk.val)
Gmax_uki_scaled = Gmax_uki.val/(G2_uki.val + G3_uki.val + G4_uki.val)
Gmax_tai_scaled = Gmax_tai.val/(G2_tai.val + G3_tai.val + G4_tai.val)
Gmax_SHCSBSB_scaled = Gmax_SHCSBSB.val/(G2_SHCSBSB.val + G3_SHCSBSB.val + G4_SHCSBSB.val)
Gmax_mod_scaled = Gmax_mod.val/(G2_mod.val + G3_mod.val + G4_mod.val)
pc1 <- c(Gmax_NKLS_scaled, Gmax_NKBS_scaled, Gmax_tewk_scaled,
Gmax_uki_scaled, Gmax_tai_scaled, Gmax_SHCSBSB_scaled,
Gmax_mod_scaled)
G2_NKLS_scaled = G2_NKLS.val/(Gmax_NKLS.val + G3_NKLS.val + G4_NKLS.val)
G2_NKBS_scaled = G2_NKBS.val/(Gmax_NKBS.val + G3_NKBS.val + G4_NKBS.val)
G2_tewk_scaled = G2_tewk.val/(Gmax_tewk.val + G3_tewk.val + G4_tewk.val)
G2_uki_scaled = G2_uki.val/(Gmax_uki.val + G3_uki.val + G4_uki.val)
G2_tai_scaled = G2_tai.val/(Gmax_tai.val + G3_tai.val + G4_tai.val)
G2_SHCSBSB_scaled = G2_SHCSBSB.val/(Gmax_SHCSBSB.val + G3_SHCSBSB.val + G4_SHCSBSB.val)
G2_mod_scaled = G2_mod.val/(Gmax_mod.val + G3_mod.val + G4_mod.val)
pc2 <- c(G2_NKLS_scaled, G2_NKBS_scaled, G2_tewk_scaled,
G2_uki_scaled, G2_tai_scaled, G2_SHCSBSB_scaled,
G2_mod_scaled)
form <- levels(formation_list)
pc_time <- as.data.frame(cbind(pc1, pc2, form))
pc_time$form <- factor(pc_time$form, levels = c("NKLS", "NKBS",
"Tewkesbury", "Upper Kai-Iwi",
"Tainui", "SHCSBSB", "modern"))
pc_time$pc1 <- as.numeric(pc_time$pc1)
pc_time$pc2 <- as.numeric(pc_time$pc2)
##evolvability over time:
ggplot(pc_time, aes(x = form)) +
geom_point(aes(y = pc1),
size = 5, shape = 15, color = "black") +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "PC1") +
plot.theme
#does not change a lot
pc_time$ages <- c(2.2, 1.9, 1.85, 0.75, 0.5, 0.45, 0)
summary(lm(pc_time$pc1 ~ pc_time$ages)) #slope of zero, non-sig
##pc2 over time:
ggplot(pc_time, aes(x = form)) +
geom_point(aes(y = pc2),
size = 5, shape = 15, color = "black") +
scale_x_discrete(name = "Formation",
guide = guide_axis(angle = 45)) +
scale_y_continuous(name = "PC1") +
plot.theme
#does not change a lot
summary(lm(pc_time$pc2 ~ pc_time$ages)) #slope of zero, non-sig
dist.NKLS_NKBS <- RiemannDist(G_ext_NKBS, G_ext_NKLS)
dist.NKBS_tewk <- RiemannDist(G_ext_NKLS, G_ext_tewk)
dist.tewk_uki <- RiemannDist(G_ext_tewk, G_ext_uki)
dist.uki_tai <- RiemannDist(G_ext_uki, G_ext_tai)
dist.tai_SHCSBSB <- RiemannDist(G_ext_tai, G_ext_SHCSBSB)
dist.SHCSBSB_mod <- RiemannDist(G_ext_SHCSBSB, G_ext_mod)
dist.gmat <- c(dist.NKLS_NKBS, dist.NKBS_tewk,
dist.tewk_uki, dist.uki_tai,
dist.tai_SHCSBSB, dist.SHCSBSB_mod, "")
dist.gmat
#### LOAD PACKAGES ----
#variance-covariance
library(jsonlite)
library(geomorph)
library(ggplot2)
library(gridExtra)
library(cowplot)
library(dplyr)
library(grid)
library(writexl)
library(tidyr)
install.packages('writexl')
install.packages('geomorph')
library(geomorph)
library(writexl)
library(tidyr)
##### FUNCTIONS ----
#I would call the the argument array something generic
euclidean_distance <- function(x, point1, point2) { #where x is an array
sum((x[point1, , 1] - x[point2, , 1])^2) ^ 0.5}
#creating a function that will take json files
#I created more arguments that way you can adjust these as needed for future use
process_json <- function(file.json,
landmarks_n, coord_n) { #need full path
data <- fromJSON(file.json)
str(data)
markups_list <- data$markups
control_points <- markups_list$controlPoints
landmarks <- control_points[[1]]
landmarks_position <- landmarks$position
landmarks_matrix <- do.call(rbind, landmarks_position)
#since array is a function name, i would name this something else
landmarks_array <- arrayspecs(landmarks_matrix, landmarks_n, coord_n, sep = NULL)
landmarks_array}
json.file <- read_json("../../../../Downloads/R scripts(1)/31582.mrk.json")
json.file
json.file$markups
#creating a function that will take json files
#I created more arguments that way you can adjust these as needed for future use
process_json <- function(file.json,
landmarks_n, coord_n) { #need full path
data <- fromJSON(file.json)
str(data)
markups_list <- data$markups
control_points <- markups_list$controlPoints
landmarks <- control_points[[1]]
landmarks_position <- landmarks$position
landmarks_matrix <- do.call(rbind, landmarks_position)
#since array is a function name, i would name this something else
landmarks_array <- arrayspecs(landmarks_matrix, landmarks_n, coord_n, sep = NULL)
landmarks_array}
process_json(json.file, 34, 3)
process_json("../../../../Downloads/R scripts(1)/31582.mrk.json", 34, 3)
x <- process_json("../../../../Downloads/R scripts(1)/31582.mrk.json", 34, 3)
x
x[1]
x[2]
x[[2]]
